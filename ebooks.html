<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Ebook - Orchestra</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">ORCHESTRA</a>
            <ul class="nav-menu">
                <li><a href="index.html">Início</a></li>
                <li><a href="partituras.html">Partituras</a></li>
                <li><a href="ebooks.html" class="active">Ebooks</a></li>
            </ul>
        </div>
    </nav>

    <section class="back-button-section">
        <div class="container">
            <a href="ebooks.html" class="back-button">← Voltar</a>
        </div>
    </section>

    <section class="ebook-hero">
        <div class="container">
            <div class="ebook-hero-grid">
                <div class="ebook-image-container">
                    <img id="ebookImage" src="https://via.placeholder.com/400" alt="Capa do Ebook">
                </div>
                <div class="ebook-info">
                    <h1 id="ebookTitle">Carregando...</h1>
                    <p id="ebookDescription">Carregando descrição...</p>
                    <div id="ebookCategoria"></div>
                    
                    <!-- PREÇO E BOTÃO JUNTOS -->
                    <div class="ebook-purchase-section">
                        <span class="ebook-price" id="ebookPrice">R$ 0,00</span>
                        <button class="btn-purchase" onclick="comprarEbook()">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" style="margin-right: 8px;">
                                <path d="M3 3H5L7 13H17L19 5H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="8" cy="17" r="1" fill="currentColor"/>
                                <circle cx="16" cy="17" r="1" fill="currentColor"/>
                            </svg>
                            Comprar Ebook
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="ebook-content-section">
        <div class="container">
            <h2>Conteúdo do Ebook</h2>
            <div class="ebook-content-box" id="ebookConteudo">
                <p>Carregando conteúdo...</p>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Orchestra Arrangement. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        let ebookAtual = null;

        async function carregarEbook() {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');

            if (!id) {
                window.location.href = 'ebooks.html';
                return;
            }

            try {
                const { data, error } = await supabase
                    .from('cursos')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;

                ebookAtual = data;
                renderizarEbook(data);
            } catch (error) {
                console.error('Erro ao carregar ebook:', error);
                alert('Erro ao carregar ebook');
                window.location.href = 'ebooks.html';
            }
        }

        function renderizarEbook(ebook) {
            document.getElementById('ebookTitle').textContent = ebook.titulo;
            document.getElementById('ebookDescription').textContent = ebook.descricao || 'Sem descrição disponível';
            document.getElementById('ebookImage').src = ebook.imagem_capa || 'https://images.unsplash.com/photo-1543002588-bfa74002ed7e?w=800';
            
            // EXIBIR PREÇO
            document.getElementById('ebookPrice').textContent = ebook.preco || 'Grátis';
            
            // EXIBIR CATEGORIA
            if (ebook.categoria) {
                document.getElementById('ebookCategoria').innerHTML = `<span class="category-badge">${ebook.categoria}</span>`;
            }
            
            // EXIBIR DESCRIÇÃO NO CONTEÚDO
            document.getElementById('ebookConteudo').innerHTML = `
                <p style="white-space: pre-wrap; line-height: 1.8;">${ebook.descricao || 'Conteúdo não disponível no momento.'}</p>
            `;

            document.title = `${ebook.titulo} - Orchestra`;
        }

        function comprarEbook() {
            if (!ebookAtual) return;
            
            alert(`Funcionalidade de compra em desenvolvimento!\n\nEbook: ${ebookAtual.titulo}\nPreço: ${ebookAtual.preco}`);
        }

        carregarEbook();
    </script>

    <style>
        .ebook-purchase-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .ebook-price {
            font-size: 32px;
            font-weight: 800;
            color: #F4B627;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-purchase {
            display: flex;
            align-items: center;
            padding: 14px 32px;
            background: linear-gradient(135deg, #F4B627 0%, #e69500 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(244, 182, 39, 0.3);
        }

        .btn-purchase:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 182, 39, 0.4);
        }

        .category-badge {
            display: inline-block;
            padding: 8px 16px;
            background: #E8E4F3;
            color: #5B4E9D;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-top: 15px;
        }

        .ebook-content-box {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
    </style>
</body>
</html>
